defmodule Poker do
  @doc"""
    Play a poker game. 
    This poker game comprises a deck of cards and hands with each five cards.
  """

  def play() do
    deck = Card.generate_deck()

    [hand1|deck]  = Card.generate_hand(deck)
    [hand2|_deck] = Card.generate_hand(deck)

    hand1_sorted = Sort.sort(hand1)
    hand2_sorted = Sort.sort(hand2)

    Score.who_is_winner?(hand1_sorted, hand2_sorted)    |>
    get_map_of_game_results(hand1_sorted, hand2_sorted) |>
    show_results
  end


  def get_map_of_game_results(results, hand1_sorted, hand2_sorted) do
    {{winner, won_with}, score} = results
    %{
      :hand1 => hand1_sorted,
      :hand2 => hand2_sorted,
      :winner => winner,
      :won_with => won_with,
      :score => score 
    }
  end


  def show_results(results) do
    IO.puts "\nResults:"
    IO.puts "------------------------------------"
    IO.inspect results[:hand1], label: "hand1 : \n"
    IO.puts "------------------------------------"
    IO.inspect results[:hand2], label: "hand2 : \n"
    IO.puts "------------------------------------"
    IO.inspect results[:winner], label: "winner is: \n"
    IO.inspect results[:score], label: "score: \n"
    IO.inspect results[:won_with], label: "won with: \n"
  end
end

